<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>RobBob News Editor</title>
  <style>
    :root {
      --bg-1: #0a0b0f;
      --bg-2: #12131a;
      --panel: rgba(10,10,20,0.8);
      --glass: rgba(255,255,255,0.08);
      --border: rgba(255,255,255,0.15);
      --accent: #a855f7;
      --accent-2: #c084fc;
      --green: #22c55e;
      --red: #ef4444;
      --muted: #cbd5e1;
      --text: #f8fafc;
      --radius: 8px;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Inter', 'Segoe UI', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #0a0b0f 0%, #1a1b2e 50%, #0a0b0f 100%);
      min-height: 100vh;
      color: var(--text);
      padding: 40px 20px;
    }

    .container {
      max-width: 900px;
      margin: 0 auto;
    }

    .header {
      text-align: center;
      margin-bottom: 40px;
    }

    .logo {
      font-size: 48px;
      font-weight: 900;
      letter-spacing: 4px;
      color: #ffffff;
      text-shadow: 0 0 30px rgba(168,85,247,0.5);
      margin-bottom: 8px;
    }

    .subtitle {
      color: var(--muted);
      font-size: 16px;
    }

    .layout {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
    }

    @media (max-width: 768px) {
      .layout {
        grid-template-columns: 1fr;
      }
    }

    .panel {
      background: var(--panel);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      backdrop-filter: blur(16px);
    }

    .panel h2 {
      color: var(--accent);
      font-size: 18px;
      margin-bottom: 20px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .form-group {
      margin-bottom: 16px;
    }

    label {
      display: block;
      font-size: 13px;
      color: var(--muted);
      margin-bottom: 6px;
    }

    input, textarea, select {
      width: 100%;
      padding: 12px 14px;
      background: var(--bg-1);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      color: var(--text);
      font-family: inherit;
      font-size: 14px;
      transition: border-color 0.2s;
    }

    input:focus, textarea:focus, select:focus {
      outline: none;
      border-color: var(--accent);
    }

    textarea {
      resize: vertical;
      min-height: 80px;
    }

    .checkbox-group {
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .checkbox-group input {
      width: auto;
    }

    .checkbox-group label {
      margin-bottom: 0;
      color: var(--text);
      font-size: 14px;
    }

    .btn {
      padding: 12px 24px;
      border: none;
      border-radius: var(--radius);
      font-family: inherit;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--accent), var(--accent-2));
      color: #fff;
      box-shadow: 0 4px 20px rgba(168,85,247,0.35);
    }

    .btn-primary:hover {
      filter: brightness(1.1);
      transform: translateY(-2px);
    }

    .btn-success {
      background: linear-gradient(135deg, var(--green), #4ade80);
      color: #fff;
    }

    .btn-success:hover {
      filter: brightness(1.1);
    }

    .btn-danger {
      background: var(--red);
      color: #fff;
    }

    .btn-ghost {
      background: var(--glass);
      color: var(--text);
      border: 1px solid var(--border);
    }

    .btn-ghost:hover {
      background: rgba(255,255,255,0.12);
    }

    .btn-group {
      display: flex;
      gap: 10px;
      margin-top: 20px;
    }

    .output-area {
      position: relative;
    }

    #jsonOutput {
      background: #0d0e12;
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      font-family: 'Fira Code', 'Consolas', monospace;
      font-size: 12px;
      line-height: 1.6;
      color: #e2e8f0;
      white-space: pre-wrap;
      word-break: break-word;
      max-height: 400px;
      overflow-y: auto;
      min-height: 200px;
    }

    .copy-btn {
      position: absolute;
      top: 10px;
      right: 10px;
    }

    .news-list {
      margin-top: 20px;
    }

    .news-item {
      background: var(--glass);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 14px;
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .news-item.pinned {
      border-color: var(--accent);
    }

    .news-item-icon {
      font-size: 24px;
    }

    .news-item-content {
      flex: 1;
      min-width: 0;
    }

    .news-item-title {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    .news-item-date {
      font-size: 11px;
      color: var(--muted);
    }

    .news-item-actions {
      display: flex;
      gap: 6px;
    }

    .news-item-actions button {
      padding: 6px 10px;
      font-size: 12px;
    }

    .toast {
      position: fixed;
      bottom: 20px;
      right: 20px;
      padding: 14px 20px;
      background: var(--panel);
      border: 1px solid var(--green);
      border-radius: var(--radius);
      color: var(--text);
      font-size: 14px;
      animation: slideUp 0.3s ease;
      z-index: 1000;
    }

    @keyframes slideUp {
      from {
        transform: translateY(20px);
        opacity: 0;
      }
      to {
        transform: translateY(0);
        opacity: 1;
      }
    }

    .instructions {
      background: var(--glass);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 16px;
      margin-top: 24px;
      font-size: 13px;
      color: var(--muted);
      line-height: 1.6;
    }

    .instructions h3 {
      color: var(--text);
      font-size: 14px;
      margin-bottom: 10px;
    }

    .instructions ol {
      margin-left: 20px;
    }

    .instructions li {
      margin-bottom: 6px;
    }

    .instructions a {
      color: var(--accent);
    }

    .emoji-select {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
      gap: 8px;
    }

    .emoji-option {
      display: flex;
      align-items: center;
      gap: 6px;
      padding: 8px;
      background: var(--glass);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      cursor: pointer;
      font-size: 13px;
      transition: all 0.2s;
    }

    .emoji-option:hover {
      border-color: var(--accent);
    }

    .emoji-option.selected {
      border-color: var(--accent);
      background: rgba(168,85,247,0.15);
    }

    .emoji-option input {
      display: none;
    }
  </style>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="logo">ROBBOB</div>
      <div class="subtitle">News Editor - Admin Panel</div>
    </header>

    <div class="layout">
      <!-- Editor Panel -->
      <div class="panel">
        <h2>üìù –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</h2>
        
        <form id="newsForm">
          <div class="form-group">
            <label for="title">–ó–∞–≥–æ–ª–æ–≤–æ–∫ *</label>
            <input type="text" id="title" placeholder="–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ v1.1" required>
          </div>

          <div class="form-group">
            <label>–ò–∫–æ–Ω–∫–∞</label>
            <div class="emoji-select" id="emojiSelect">
              <label class="emoji-option selected">
                <input type="radio" name="emoji" value="rocket" checked>
                <span>üöÄ</span> –†–µ–ª–∏–∑
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="shield">
                <span>üõ°Ô∏è</span> –ó–∞—â–∏—Ç–∞
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="zap">
                <span>‚ö°</span> –°–∫–æ—Ä–æ—Å—Ç—å
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="star">
                <span>‚≠ê</span> –í–∞–∂–Ω–æ
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="fire">
                <span>üî•</span> –ì–æ—Ä—è—á–µ–µ
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="gift">
                <span>üéÅ</span> –ü–æ–¥–∞—Ä–æ–∫
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="fix">
                <span>üîß</span> –§–∏–∫—Å
              </label>
              <label class="emoji-option">
                <input type="radio" name="emoji" value="game">
                <span>üéÆ</span> –ò–≥—Ä–∞
              </label>
            </div>
          </div>

          <div class="form-group">
            <label for="content">–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ *</label>
            <textarea id="content" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ—Å—Ç–∏..." required></textarea>
          </div>

          <div class="form-group">
            <label for="link">–°—Å—ã–ª–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)</label>
            <input type="url" id="link" placeholder="https://...">
          </div>

          <div class="form-group">
            <div class="checkbox-group">
              <input type="checkbox" id="pinned">
              <label for="pinned">üìå –ó–∞–∫—Ä–µ–ø–∏—Ç—å –Ω–æ–≤–æ—Å—Ç—å</label>
            </div>
          </div>

          <div class="btn-group">
            <button type="submit" class="btn btn-primary">+ –î–æ–±–∞–≤–∏—Ç—å</button>
            <button type="button" class="btn btn-ghost" id="clearForm">–û—á–∏—Å—Ç–∏—Ç—å</button>
          </div>
        </form>

        <!-- News List -->
        <div class="news-list" id="newsList">
          <h3 style="margin: 20px 0 12px; font-size: 14px; color: var(--muted);">–î–æ–±–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–æ–≤–æ—Å—Ç–∏:</h3>
          <div id="newsItems">
            <p style="color: var(--muted); font-size: 13px;">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π</p>
          </div>
        </div>
      </div>

      <!-- Output Panel -->
      <div class="panel">
        <h2>üìã JSON –¥–ª—è GitHub Gist</h2>
        
        <div class="output-area">
          <button class="btn btn-ghost copy-btn" id="copyBtn">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
          <div id="jsonOutput">{
  "version": 1,
  "lastUpdated": "",
  "news": []
}</div>
        </div>

        <div class="btn-group">
          <button class="btn btn-success" id="downloadBtn">üíæ –°–∫–∞—á–∞—Ç—å JSON</button>
          <button class="btn btn-danger" id="clearAll">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å—ë</button>
        </div>

        <div class="instructions">
          <h3>üìñ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:</h3>
          <ol>
            <li>–î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É—è —Ñ–æ—Ä–º—É —Å–ª–µ–≤–∞</li>
            <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π JSON</li>
            <li>–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ <a href="https://gist.github.com" target="_blank">GitHub Gist</a></li>
            <li>–°–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª <code>news.json</code></li>
            <li>–í—Å—Ç–∞–≤—å—Ç–µ JSON –∏ —Å–æ—Ö—Ä–∞–Ω–∏—Ç–µ</li>
            <li>–°–∫–æ–ø–∏—Ä—É–π—Ç–µ Raw URL –≤–∞—à–µ–≥–æ Gist</li>
            <li>–í—Å—Ç–∞–≤—å—Ç–µ URL –≤ <code>src/scripts/news.js</code> (GIST_URL)</li>
          </ol>
        </div>
      </div>
    </div>
  </div>

  <script>
    // News data storage
    let newsData = {
      version: 1,
      lastUpdated: new Date().toISOString(),
      news: []
    };

    // DOM Elements
    const form = document.getElementById('newsForm');
    const jsonOutput = document.getElementById('jsonOutput');
    const newsItems = document.getElementById('newsItems');
    const copyBtn = document.getElementById('copyBtn');
    const downloadBtn = document.getElementById('downloadBtn');
    const clearAll = document.getElementById('clearAll');
    const clearForm = document.getElementById('clearForm');
    const emojiOptions = document.querySelectorAll('.emoji-option');

    // Emoji map
    const emojiMap = {
      'rocket': 'üöÄ',
      'shield': 'üõ°Ô∏è',
      'zap': '‚ö°',
      'star': '‚≠ê',
      'fire': 'üî•',
      'gift': 'üéÅ',
      'fix': 'üîß',
      'game': 'üéÆ'
    };

    // Load from localStorage
    function loadData() {
      const saved = localStorage.getItem('robbob_news_editor');
      if (saved) {
        try {
          newsData = JSON.parse(saved);
          updateOutput();
          renderNewsList();
        } catch (e) {}
      }
    }

    // Save to localStorage
    function saveData() {
      localStorage.setItem('robbob_news_editor', JSON.stringify(newsData));
    }

    // Update JSON output
    function updateOutput() {
      newsData.lastUpdated = new Date().toISOString();
      jsonOutput.textContent = JSON.stringify(newsData, null, 2);
    }

    // Render news list
    function renderNewsList() {
      if (newsData.news.length === 0) {
        newsItems.innerHTML = '<p style="color: var(--muted); font-size: 13px;">–ù–µ—Ç –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö –Ω–æ–≤–æ—Å—Ç–µ–π</p>';
        return;
      }

      newsItems.innerHTML = newsData.news.map((item, index) => `
        <div class="news-item ${item.pinned ? 'pinned' : ''}">
          <span class="news-item-icon">${emojiMap[item.emoji] || 'üì∞'}</span>
          <div class="news-item-content">
            <div class="news-item-title">${escapeHtml(item.title)}</div>
            <div class="news-item-date">${item.date}</div>
          </div>
          <div class="news-item-actions">
            <button class="btn btn-ghost" onclick="editNews(${index})">‚úèÔ∏è</button>
            <button class="btn btn-danger" onclick="deleteNews(${index})">üóëÔ∏è</button>
          </div>
        </div>
      `).join('');
    }

    // Generate unique ID
    function generateId() {
      return 'news-' + Date.now() + '-' + Math.random().toString(36).substr(2, 9);
    }

    // Escape HTML
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Handle emoji selection
    emojiOptions.forEach(option => {
      option.addEventListener('click', () => {
        emojiOptions.forEach(o => o.classList.remove('selected'));
        option.classList.add('selected');
      });
    });

    // Form submit
    form.addEventListener('submit', (e) => {
      e.preventDefault();

      const title = document.getElementById('title').value.trim();
      const content = document.getElementById('content').value.trim();
      const link = document.getElementById('link').value.trim();
      const pinned = document.getElementById('pinned').checked;
      const emoji = document.querySelector('input[name="emoji"]:checked').value;

      if (!title || !content) return;

      const newsItem = {
        id: generateId(),
        title,
        emoji,
        content,
        date: new Date().toISOString().split('T')[0],
        pinned,
        link: link || null
      };

      newsData.news.unshift(newsItem);
      saveData();
      updateOutput();
      renderNewsList();
      
      // Reset form
      form.reset();
      emojiOptions.forEach(o => o.classList.remove('selected'));
      emojiOptions[0].classList.add('selected');
      
      showToast('–ù–æ–≤–æ—Å—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∞!');
    });

    // Delete news
    window.deleteNews = function(index) {
      if (confirm('–£–¥–∞–ª–∏—Ç—å —ç—Ç—É –Ω–æ–≤–æ—Å—Ç—å?')) {
        newsData.news.splice(index, 1);
        saveData();
        updateOutput();
        renderNewsList();
        showToast('–ù–æ–≤–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∞');
      }
    };

    // Edit news (populate form)
    window.editNews = function(index) {
      const item = newsData.news[index];
      document.getElementById('title').value = item.title;
      document.getElementById('content').value = item.content;
      document.getElementById('link').value = item.link || '';
      document.getElementById('pinned').checked = item.pinned;
      
      // Select emoji
      emojiOptions.forEach(o => {
        o.classList.remove('selected');
        if (o.querySelector('input').value === item.emoji) {
          o.classList.add('selected');
          o.querySelector('input').checked = true;
        }
      });

      // Remove item and scroll to form
      newsData.news.splice(index, 1);
      saveData();
      updateOutput();
      renderNewsList();
      
      window.scrollTo({ top: 0, behavior: 'smooth' });
      document.getElementById('title').focus();
    };

    // Copy to clipboard
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(jsonOutput.textContent);
        showToast('JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
      } catch (e) {
        // Fallback
        const textarea = document.createElement('textarea');
        textarea.value = jsonOutput.textContent;
        document.body.appendChild(textarea);
        textarea.select();
        document.execCommand('copy');
        document.body.removeChild(textarea);
        showToast('JSON —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω!');
      }
    });

    // Download JSON
    downloadBtn.addEventListener('click', () => {
      const blob = new Blob([JSON.stringify(newsData, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = 'news.json';
      a.click();
      URL.revokeObjectURL(url);
      showToast('–§–∞–π–ª —Å–∫–∞—á–∞–Ω!');
    });

    // Clear all
    clearAll.addEventListener('click', () => {
      if (confirm('–û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –Ω–æ–≤–æ—Å—Ç–∏?')) {
        newsData.news = [];
        saveData();
        updateOutput();
        renderNewsList();
        showToast('–í—Å–µ –Ω–æ–≤–æ—Å—Ç–∏ —É–¥–∞–ª–µ–Ω—ã');
      }
    });

    // Clear form
    clearForm.addEventListener('click', () => {
      form.reset();
      emojiOptions.forEach(o => o.classList.remove('selected'));
      emojiOptions[0].classList.add('selected');
    });

    // Toast notification
    function showToast(message) {
      const existing = document.querySelector('.toast');
      if (existing) existing.remove();

      const toast = document.createElement('div');
      toast.className = 'toast';
      toast.textContent = message;
      document.body.appendChild(toast);

      setTimeout(() => {
        toast.style.opacity = '0';
        toast.style.transition = 'opacity 0.3s';
        setTimeout(() => toast.remove(), 300);
      }, 2500);
    }

    // Initialize
    loadData();
  </script>
</body>
</html>
